#import "lib/ilm.typ": *

#set text(lang: "ru")
#set math.equation(numbering: "1")

#show ref: it => {
  lower(it)
}


#show: ilm.with(
  title: [Применение методов вычислительной математики в задачах управления],
  author: 
    "Панков Василий <pank-su>",
  author-format: (author) => [
    #stack(dir: ltr)[#block(
        image("images/000_avatar.png", width: 3em, height: 3em),
        radius: 50%,
        clip: true,
      )][#h(1em)][#text(author, size: 1.6em)]
  ],
  date: datetime.today(),
  abstract: [Доклад],
  table-of-contents: none,
  external-link-circle: false
)


= Введение

Доброе утро, я Панков Василий, и сегодня я расскажу вам о применении методов вычислительной математики в задачах управления. Мы рассмотрим, как математические модели и алгоритмы могут помочь нам в оптимизации управления системами.

Начнем с "базы":


*Вычислительная математика* фактически даёт нам возможность рассчитать что-либо альтернативным способом, с определённой точностью. В основном оптимизируя и структурируя вычисления для компьютера.

== Система управления

Вспомним лекции:

/ Управление: это целенаправленное воздействие на объект или процесс для поддержания его состояния или внесения заданных изменений.

/ Система управления: комплекс взаимосвязанных компонентов, обладающий свойством целостности: при вступлении элементов в связи возникают новые свойства, не характерные по отдельности.

#figure(image("images/001_система_управления.png"))

Для выбора вычислительного метода критически важна классификация задач управления по степени их формализации:
- *Хорошо структурированные*: полностью формализуемые задачи.
- *Слабо структурированные*: задачи с неопределенностью, где вычислительные методы сочетаются с экспертными оценками.
- *Неструктурированные*: задачи, решаемые преимущественно эвристическими методами.



= Математическое описание и переходная матрица

Перейдем на более высокий уровень абстракции и рассмотрим взаимодействие нескольких систем управления.
В рамках системного подхода мы рассматриваем иерархию "элемент — устройство — система"

От одномерной системы перейдем к многомерной

#figure(image("images/002_многомерной_систем.png"),)

Данную систему называют *многомерной линейной нестационарной системой* (МЛНС).

*Многомерные линейные нестационарные системы* в отличие от одномерных имеют $r$ входов и $k$ выходов.

Тогда сигналы описываем в виде векторов:

$
  g(t) = vec(g_1(t), dots.v, g_r(t)), space y(t) = vec(y_1(t), dots.v, y_k(t))
$

Описывается система с помощью уравнения состояния:

$
  dot(x) = A(t) x(t) + B(t) g(t)
$


с начальным условиями:

$
  x(t_0) = x_0
$

и уравнениями выхода:

$
  y(t) = C(t) x(t)
$

где:
- $x(t)$ - n-мерный вектор состояния системы
- $g(t)$ - r-мерный вектор входных взаимодействий (управлений)
- $y(t)$ - k-мерный вектор выходов системы
- $x_0$ - начальное состояние системы
- $t$ - время

- $A(t)$, $B(t)$, $C(t)$ - матрицы размеров соответственно $n times n$, $n times r$, $k times n$ 


Если $r = 1$ и $k = 1$, то система называется *одномерной*.

Если $A$, $B$, $C$ не зависят от времени $t$, то система называется *стационарной*.

== Пример

Записать уравнения состояния и выхода системы:
$
  cases(
    dot(x)_1 = x_2 + g_1,
    dot(x)_2 = -x_1 + 2x_2 - 3g_1
  ), quad y_1 = x_2
$
в матричной форме.

Определяем размерности сигналов: $n = 2, r = 1, k = 1$ и записываем соответствующие уравнения:

$
  dif/(dif t) vec(x_1, x_2) = 
  underbrace(mat(0, 1; -1, 2), A(t)) 
  vec(x_1, x_2) 
  + 
  underbrace(vec(1, -3), B(t)) 
  g_1, 
  quad 
  y_1 = 
  underbrace(mat(0, 1), C(t)) 
  vec(x_1, x_2)
$

== Переходная матрица (матрица Коши)

Для анализа выходных процессов системы, нужно найти закон изменения вектора состояния. Реакция системы (выходной сигнал) состоит из двух частей:

- *Свободное движение* - реакция системы при нулевом входе ($g(t) = 0$)
- *Вынужденное движение* - реакция системы на внешнее воздействие при нулевых начальных условиях ($x_0 = 0$)

Закон изменения вектора состояния задаётся формулой:

$
  x(t) = Phi(t, t_0) x_0 + integral_(t_0)^t Phi(t, tau) B(tau) g(tau) dif tau
$

В этом выражении $Phi(t, tau)$ - *переходная матрица* (или *матрица Коши*), являющаяся решением уравнения:

$
  (partial Phi(t, tau))/(partial t) = A(t) Phi(t, tau) quad Phi(tau, tau) = E
$

$E$ - единичная матрица.

Для стационарных систем (где $A$, $B$, $C$ не зависят от времени) переходная матрица может быть выражена через экспоненту матрицы:

$
  Phi(t, tau) = e^(A (t - tau))
$

При этом переходная матрица зависит только от разности аргументов: $Phi(t, tau) = Phi(t - tau)$.

=== Свойства переходной матрицы

- $Phi(t, tau) = Phi(t, t_0) Phi(t_0, tau)$
- $Phi(t, tau)^(-1) = Phi(tau, t)$
- *Формула Лиувилля-Остроградского*: $det(Phi(t, t_0)) = exp(integral_(t_0)^t tr(A(tau)) dif tau)$. Она позволяет отслеживать накопление численной ошибки при интегрировании.

=== Вычислительная математика и переходная матрица

Так причем тут вычислительная математика? 

Так как для нестационарных систем $A(t)$ зависит от времени, то аналитическое решение уравнения для $Phi(t, tau)$ может быть сложным или невозможным. Поэтому мы прибегаем к численным методам для приближенного вычисления переходной матрицы.

==== Ряд Тейлора

Переходную матрицу (экспоненту матрицы) можно разложить в ряд Тейлора:

$
  e^(A tau) = sum_(n=0)^infinity (A^n tau^n) / n!
$

Проблемы:
- Сходимость ряда может быть медленной, особенно для больших значений $tau$.
- Сложность: каждый член требует перемножения матриц, что имеет сложность $O(n^3)$ для матриц размера $n times n$.





==== Использование теоремы Кели-Гамильтона (метод Сильвестра) 

Согласно теореме Кэли-Гамильтона, любая квадратная матрица $A$ порядка $n$ удовлетворяет своему характеристическому уравнению. Это означает, что любую степень матрицы $A^k$ (где $k >= n$) можно выразить через линейную комбинацию её младших степеней ($E, A, A^2, dots, A^(n-1)$).

Алгоритм реализации:

+ Находим собственные числа $lambda_i$ матрицы $A$ (решая характеристическое уравнение $det(A - lambda E) = 0$).
+ Записываем экспоненту как полином:
  $e^(A tau) = alpha_0(tau) E + alpha_1(tau) A + dots + alpha_(n-1)(tau) A^(n-1)$
+ Составляем систему из $n$ уравнений для нахождения неизвестных коэффициентов $alpha_i (tau)$, используя условия $e^(lambda_i tau) = alpha_0(tau) + alpha_1(tau) lambda_i + dots + alpha_(n-1)(tau) lambda_i^(n-1)$ для каждого собственного числа $lambda_i$.


Преимущества:
- Быстрое вычисление экспоненты матрицы, особенно для больших $tau$
- Сложность: нахождение собственных чисел и решение системы линейных уравнений имеет сложность $O(n^3)$, что может быть эффективнее, чем прямое перемножение матриц для больших степеней.

Есть и другие методы, но если я буду перечислять все, то доклад будет бесконечным, так что остановимся на этих двух.

= Дискретизация и численное интегрирование

Сейчас мы рассмотрели системы в непрерывном времени, но 
если мы захотим смоделировать систему на компьютере, то нам необходимо перейти к дискретному времени. 

Обозначим фиксированный шаг дискретизации как $T$.

Вернемся к уравнению состояния:

$
  dot(x) = A(t) x(t) + B(t) g(t)
$

Преобразуем его в дискретную форму:

$
  x_(k + 1) = A_d x_k + B_d g_k
$

Вычисление этих матриц представляет собой нетривиальную алгоритмическую задачу.
Дискретная матрица $A_d$ строго равна матричной экспоненте за один шаг дискретизации:

$
  A_d = e^(A T)
$

Тогда дискретная матрица $B_d$ может быть вычислена через интеграл:
$
  B_d = integral_0^T e^(A tau) B dif tau
$

В данном случае мы можем использовать численные методы интегрирования.

== Метод прямоугольников

Метод прямоугольников - это базовый численный метод для приближенного вычисления определенных интегралов. Он основан на разбиении области интегрирования на равные отрезки и аппроксимации площади под кривой суммой площадей прямоугольников.

Для вычисления интеграла $integral_a^b f(x) dif x$ разбиваем отрезок $[a, b]$ на $n$ равных частей с шагом $h = (b - a) / n$.

Существует три основных варианта метода:

*Метод левых прямоугольников:*
$
  integral_a^b f(x) dif x approx h sum_(i=0)^(n-1) f(x_i)
$

где $x_i = a + i h$ - левая граница $i$-го отрезка.

*Метод правых прямоугольников:*
$
  integral_a^b f(x) dif x approx h sum_(i=1)^n f(x_i)
$

*Метод средних прямоугольников:*
$
  integral_a^b f(x) dif x approx h sum_(i=0)^(n-1) f((x_i + x_(i+1))/2)
$

Применительно к вычислению дискретной матрицы $B_d$:
$
  B_d = integral_0^T e^(A tau) B dif tau approx h sum_(i=0)^(n-1) e^(A tau_i) B
$

Преимущества:
- Простота реализации
- Низкая вычислительная стоимость
- Интуитивная геометрическая интерпретация

Недостатки:
- Низкая точность (первый порядок для левых/правых, второй для средних)
- Требует малого шага $h$ для достижения приемлемой точности
- Погрешность $O(h^2)$ для левых/правых прямоугольников, $O(h^3)$ для средних

#figure(
  image("images/003_rectangles.png", width: 80%),
  caption: [Метод левых прямоугольников: площадь под кривой аппроксимируется суммой прямоугольников]
)

== Метод трапеций

Метод трапеций - это численный метод интегрирования, который обеспечивает более высокую точность по сравнению с методом прямоугольников. Он основан на аппроксимации площади под кривой суммой площадей трапеций.

Для вычисления интеграла $integral_a^b f(x) dif x$ разбиваем отрезок $[a, b]$ на $n$ равных частей с шагом $h = (b - a) / n$.

Формула метода трапеций:
$
  integral_a^b f(x) dif x approx h/2 (f(x_0) + 2 sum_(i=1)^(n-1) f(x_i) + f(x_n))
$

где $x_i = a + i h$ - узлы разбиения.

Геометрически это означает, что на каждом отрезке $[x_i, x_(i+1)]$ функция аппроксимируется прямой линией, соединяющей точки $(x_i, f(x_i))$ и $(x_(i+1), f(x_(i+1)))$, а площадь под этой линией вычисляется как площадь трапеции:

$
  S_i = h/2 (f(x_i) + f(x_(i+1)))
$

Применительно к вычислению дискретной матрицы $B_d$:
$
  B_d = integral_0^T e^(A tau) B dif tau approx h/2 (B + 2 sum_(i=1)^(n-1) e^(A tau_i) B + e^(A T) B)
$

Преимущества:
- Более высокая точность по сравнению с методом прямоугольников
- Локальная погрешность $O(h^3)$, глобальная погрешность $O(h^2)$ — второй порядок точности
- Простота реализации
- Хорошо подходит для гладких функций

Недостатки:
- Требует вычисления функции в большем количестве точек
- Для негладких функций точность может снижаться
- Все еще требует достаточно малого шага для высокой точности

#figure(
  image("images/004_trapezoids.png", width: 80%),
  caption: [Метод трапеций: площадь под кривой аппроксимируется суммой трапеций, образованных линейной интерполяцией между соседними точками]
)

== Метод Эйлера

Метод Эйлера - это базовый численный метод для решения обыкновенных дифференциальных уравнений. Он основан на линейной аппроксимации решения.

=== Идея метода

Для уравнения $dot(x) = f(t, x)$ с начальным условием $x(t_0) = x_0$ разложим решение в ряд Тейлора:
$
  x(t_(k+1)) approx x(t_k) + dot(x)(t_k) T = x(t_k) + f(t_k, x_k) T
$

Отсюда получаем итерационную формулу:
$
  x_(k + 1) = x_k + T f(t_k, x_k)
$

Для системы управления $dot(x) = A x + B g$:
$
  x_(k + 1) = x_k + T (A x_k + B g_k) = (E + T A) x_k + T B g_k
$

=== Геометрическая интерпретация

На каждом шаге метод:
1. Вычисляет касательную к решению в текущей точке
2. Движется вдоль этой касательной на временной интервал $T$

Это даёт ломаную линию, аппроксимирующую истинное решение.

=== Точность и устойчивость

- *Локальная погрешность:* $O(T^2)$ на одном шаге
- *Глобальная погрешность:* $O(T)$ - метод первого порядка
- *Устойчивость:* условная, требует $|1 + T lambda| < 1$ для собственных значений $lambda$

Преимущества:
- Простота реализации
- Низкая вычислительная стоимость (одно вычисление $f$ на шаг)

Недостатки:
- Низкая точность - требует малого шага
- Может быть неустойчивым для жёстких систем
- Накопление погрешности при длительном интегрировании

#figure(
  image("images/005_euler.png", width: 80%),
  caption: [Метод Эйлера для уравнения $dot(x) = -x$ с $x(0) = 1$. Красная ломаная - численное решение, синяя пунктирная - точное решение $x(t) = e^(-t)$. Видно отклонение из-за низкой точности метода]
)

== Метод Рунге-Кутта 4-го порядка

Метод Рунге-Кутта 4-го порядка (RK4) - это более сложный численный метод, который обеспечивает более высокую точность по сравнению с методом Эйлера. Он использует четыре оценки производной для вычисления следующего значения функции.

Вычисляем касательные в 4 разных точках:

$T$ - шаг дискретизации, $t_k$ - текущее время, $x_k$ - текущее значение вектора состояния.

+ $k_1 = f(t_k, x_k)$
+ $k_2 = f(t_k + T/2, x_k + (T/2) k_1)$
+ $k_3 = f(t_k + T/2, x_k + (T/2) k_2)$
+ $k_4 = f(t_k + T, x_k + T k_3)$

Итоговое значение вектора состояния на следующем такте собирается как взвешенная сумма этих коэффициентов:
$
  x_(k + 1) = x_k + (T/6) (k_1 + 2 k_2 + 2 k_3 + k_4)
$

Вычислительная суть этого метода в том, что он алгебраически эквивалентен удержанию членов ряда Тейлора вплоть до четвертой степени, 
но при этом машине не нужно вычислять сложные аналитические производные высоких порядков. Метод RK4 требует четырех обращений к правой части функции за один такт,
 что делает его вычислительно затратным, но взамен обеспечивает колоссальную точность с глобальной погрешностью $O(T^4)$,
 предотвращая расходимость системы управления в реальном времени.

=== Идея метода

Метод RK4 использует *взвешенное среднее четырёх наклонов* для достижения высокой точности без вычисления производных высших порядков:

$
  x_(k+1) = x_k + T/6 (k_1 + 2k_2 + 2k_3 + k_4)
$

где коэффициенты вычисляются последовательно:
- $k_1 = f(t_k, x_k)$ - наклон в начале интервала
- $k_2 = f(t_k + T/2, x_k + (T/2) k_1)$ - наклон в середине (предсказание через $k_1$)
- $k_3 = f(t_k + T/2, x_k + (T/2) k_2)$ - улучшенный наклон в середине (через $k_2$)
- $k_4 = f(t_k + T, x_k + T k_3)$ - наклон в конце (предсказание через $k_3$)

Веса $1/6, 2/6, 2/6, 1/6$ обеспечивают совпадение с рядом Тейлора до $O(T^4)$.

=== Точность и эффективность

- *Локальная погрешность:* $O(T^5)$ на одном шаге
- *Глобальная погрешность:* $O(T^4)$ - метод четвёртого порядка
- *Стоимость:* 4 вычисления функции $f$ на шаг

Для точности $epsilon$:
- Метод Эйлера требует $O(epsilon^(-1))$ вычислений
- RK4 требует $O(epsilon^(-1/4))$ вычислений - *существенно эффективнее*

Пример: для улучшения точности в 10 раз RK4 требует увеличения вычислений всего в ~1.78 раз, против 10 раз для Эйлера.

=== Устойчивость и применение

RK4 обладает *значительно лучшей устойчивостью* по сравнению с методом Эйлера, что позволяет использовать бóльшие шаги дискретизации.

Применяется в:
- Симуляторах систем управления (Simulink, Modelica)
- Контроллерах реального времени
- Верификации алгоритмов управления
- Научных расчётах

RK4 является *стандартом де-факто* для моделирования систем управления благодаря оптимальному балансу точности, устойчивости и вычислительной стоимости.

#figure(
  image("images/006_rk4.png", width: 80%),
  caption: [Метод Рунге-Кутта 4-го порядка для того же уравнения $dot(x) = -x$. Зелёная линия практически совпадает с точным решением (синяя пунктирная), демонстрируя превосходную точность метода даже при крупном шаге]
)

= Другие методы вычислительной математики в задачах управления

Помимо рассмотренных методов численного интегрирования и вычисления переходной матрицы, в задачах управления широко применяются и другие методы вычислительной математики:

== Методы оптимизации

*Градиентные методы* используются для настройки параметров регуляторов и минимизации функционалов качества управления. Метод градиентного спуска, метод сопряжённых градиентов и квазиньютоновские методы (BFGS) позволяют находить оптимальные коэффициенты ПИД-регуляторов и других контроллеров.

*Линейное и квадратичное программирование* применяется в задачах оптимального управления с ограничениями. LQR-регулятор (линейно-квадратичный регулятор) является классическим примером, где решается задача минимизации квадратичного функционала.

== Методы решения систем линейных уравнений

При анализе и синтезе систем управления часто возникает необходимость решать системы линейных алгебраических уравнений:
- *Метод Гаусса* — прямой метод с вычислительной сложностью $O(n^3)$
- *LU-разложение* — эффективно при многократном решении систем с одной матрицей
- *Итерационные методы* (Якоби, Гаусса-Зейделя) — для разреженных матриц большой размерности

== Методы нахождения собственных значений

Собственные значения матрицы $A$ определяют устойчивость системы управления:
- *QR-алгоритм* — стандартный метод для вычисления всех собственных значений
- *Степенной метод* — для нахождения наибольшего по модулю собственного значения
- *Метод обратных итераций* — для нахождения собственного значения, ближайшего к заданному

== Интерполяция и аппроксимация

*Сплайн-интерполяция* используется для сглаживания измерений и построения траекторий. Кубические сплайны обеспечивают гладкость второй производной, что важно для планирования движения.

*Метод наименьших квадратов* применяется для идентификации параметров системы по экспериментальным данным и фильтрации шумов.

== Быстрое преобразование Фурье (БПФ)

БПФ с вычислительной сложностью $O(n log n)$ используется для:
- Спектрального анализа сигналов
- Проектирования цифровых фильтров
- Анализа частотных характеристик систем управления

= Заключение

В данном докладе были рассмотрены основные методы вычислительной математики, применяемые в задачах управления.

*Ключевые результаты:*

1. *Математическое описание систем управления* — многомерные линейные системы описываются уравнениями состояния в матричной форме, что позволяет применять эффективные численные алгоритмы.

2. *Вычисление переходной матрицы* — для анализа динамики систем используются методы разложения в ряд Тейлора и метод Сильвестра (на основе теоремы Кэли-Гамильтона), каждый из которых имеет свои преимущества в зависимости от характеристик системы.

3. *Численное интегрирование* — методы прямоугольников и трапеций позволяют вычислять дискретные матрицы системы, необходимые для компьютерного моделирования.

4. *Решение дифференциальных уравнений* — метод Эйлера обеспечивает простоту реализации, тогда как метод Рунге-Кутта 4-го порядка является стандартом для моделирования систем управления благодаря оптимальному балансу точности ($O(T^4)$) и вычислительной стоимости.

*Практическая значимость:*

Рассмотренные методы составляют основу современных систем автоматизированного проектирования (MATLAB/Simulink, Scilab, Modelica) и встраиваемых систем управления реального времени. Понимание их принципов работы, точности и ограничений позволяет инженерам выбирать оптимальные алгоритмы для конкретных задач и обеспечивать надёжную работу систем управления.

Вычислительная математика является неотъемлемой частью современной теории управления, обеспечивая переход от аналитических моделей к практическим реализациям в цифровых системах.